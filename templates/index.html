<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Exam Proctoring</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="/static/styles.css" />
  </head>

  <body>
    <div id="startPage" class="full-center start-intro">
      <div class="instructions-card">
        <div class="instructions-header">
          <div class="icon-badge">ğŸ“˜</div>
          <div>
            <h2>Exam Instructions</h2>
            <p>Applies to every test session</p>
          </div>
        </div>
        <ul class="instructions-list">
          <li>Use a quiet, well-lit room and keep your face within camera view.</li>
          <li>Ensure a stable internet connection, charged device, and plugged-in power.</li>
          <li>Disable notifications and close all other tabs or applications.</li>
          <li>Keep your ID card handy for verification. External materials are not allowed.</li>
          <li>Audio and video monitoring stay active throughout the exam.</li>
        </ul>
        <div class="instructions-footnote">
          <span>âš ï¸ Leaving the window or speaking loudly may trigger violations.</span>
        </div>
      </div>

      <div class="start-actions">
        <h3>Ready to begin?</h3>
        <p>You will enter secure proctoring mode. Camera and microphone access are required.</p>
        <button id="startBtn" class="primary-large">Start Test</button>
        <small class="start-note">By continuing you confirm you have read all instructions.</small>
      </div>
    </div>

    <div id="testArea" class="hidden test-layout">
      <!-- Top Header Bar -->
      <div class="exam-header">
        <div class="header-left">
          <h2 id="examTitle">Exam in Progress</h2>
          <div class="timer-container">
            <span class="timer-icon">â±ï¸</span>
            <div class="timer-display">
              <span id="timer">00:00</span>
              <span class="timer-label">Time Remaining</span>
            </div>
          </div>
        </div>
        <div class="header-right">
          <div class="proctoring-status">
            <div class="status-indicator" id="proctoringStatus">
              <span class="status-dot"></span>
              <span class="status-text">Monitoring Active</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Top-right camera with enhanced UI -->
      <div class="video-wrap">
        <div class="video-header">
          <span class="camera-icon">ğŸ“¹</span>
          <span class="camera-label">Live Proctoring</span>
          <div class="face-indicator" id="faceIndicator">
            <span class="indicator-dot"></span>
            <span>Face Detected</span>
          </div>
        </div>
        <div class="video-feed">
          <video id="video" autoplay muted playsinline></video>
          <canvas id="overlay"></canvas>
        </div>
        <div class="video-footer">
          <div class="status-item">
            <span class="status-icon">ğŸ‘¤</span>
            <span id="faceCount">Faces: 0</span>
          </div>
          <div class="status-item">
            <span class="status-icon">ğŸ”Š</span>
            <span id="audioStatus">Audio: Normal</span>
          </div>
        </div>
      </div>

      <!-- Proctoring Stats Panel -->
      <div class="proctoring-stats">
        <div class="stat-card">
          <div class="stat-icon">ğŸ“</div>
          <div class="stat-info">
            <div class="stat-value" id="answeredCount">0</div>
            <div class="stat-label">Answered</div>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">ğŸ“Š</div>
          <div class="stat-info">
            <div class="stat-value" id="progressPercent">0%</div>
            <div class="stat-label">Progress</div>
          </div>
        </div>
      </div>

      <!-- Questions Panel -->
      <div id="questionPanel" class="question-panel"></div>
      
      <div id="statusText" style="display: none"></div>
      <div id="voiceStatus" style="display: none"></div>

      <!-- Submit Section -->
      <div class="submit-section">
        <button id="submitBtn" class="primary-submit">
          <span class="submit-icon">âœ“</span>
          <span>Submit Test</span>
        </button>
        <p class="submit-warning">âš ï¸ Make sure you've answered all questions before submitting</p>
      </div>

      <!-- Logs Panel (collapsible) -->
      <div class="log-panel">
        <div class="log-header" id="logToggle">
          <h3>
            <span class="log-icon">ğŸ“‹</span>
            Recent Events
            <span class="toggle-icon">â–¼</span>
          </h3>
        </div>
        <div class="log-content" id="logContent">
          <pre id="events"></pre>
        </div>
      </div>

      <!-- Warning popups (bottom right) -->
      <div id="warningBox" class="warning-box"></div>
    </div>

    <div id="completePage" class="hidden full-center">
      <h2>Test Submitted</h2>
      <button id="restartBtn" class="secondary">Back to Start</button>
    </div>

    <script src="/static/script.js"></script>
  </body>
</html>
